<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="https://i.icomoon.io/public/temp/31d5802389/UntitledProject/style.css">
    <title>JASON TEST DATA</title>
    <script id="detail-template" type="text/x-handlebars-template">
        <div id="res detail">
        <h1>{{name}}</h1>
        <img id="detail-image" src="{{featured_image}}">
        <ul>
            <li>Cuisines: {{cuisines}}</li>
            <li>Cost for Two: ${{average_cost_for_two}}</li>
            <li>Rating: {{aggregate_rating}}</li>
            <li>Website: <a href="{{url}}">{{name}}</a></li>
        </ul> 
    </div>
      </script>

</head>
<body>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script>
        $(document).ready(function(){
            var submitIcon = $('.searchbox-icon');
            var inputBox = $('.searchbox-input');
            var searchBox = $('.searchbox');
            var isOpen = false;
            submitIcon.click(function(){
                if(isOpen == false){
                    searchBox.addClass('searchbox-open');
                    inputBox.focus();
                    isOpen = true;
                } else {
                    searchBox.removeClass('searchbox-open');
                    inputBox.focusout();
                    isOpen = false;
                }
            });  
             submitIcon.mouseup(function(){
                    return false;
                });
            searchBox.mouseup(function(){
                    return false;
                });
            $(document).mouseup(function(){
                    if(isOpen == true){
                        $('.searchbox-icon').css('display','block');
                        submitIcon.click();
                    }
                });
        });
            function buttonUp(){
                var inputVal = $('.searchbox-input').val();
                inputVal = $.trim(inputVal).length;
                if( inputVal !== 0){
                    $('.searchbox-icon').css('display','none');
                } else {
                    $('.searchbox-input').val('');
                    $('.searchbox-icon').css('display','block');
                }
            }
        </script>
        <div class="container">
                <form class="searchbox">
                    <input type="search" placeholder="Search......" name="search" class="searchbox-input" onkeyup="buttonUp();" required>
                    <input type="submit" class="searchbox-submit" value="GO">
                    <span class="searchbox-icon" class="icon-search">&#x1f50d;</span>
                </form>
            </div>

    
    <h1 id="title">Chow Down</h1>
        
    <script>
        $(document).ready(function(){
            $(".menu-btn").click(function(event){
              event.preventDefault();
              $("nav").toggleClass("menushow");
              
              
            });
          });
        </script>
            
         <nav>
                        <div class="menu-btn">
                            <a href="#">+</a>
                        </div>
                        <h1>Filter By</h1>
                        
                            <h3><a href="#">Cuisines</a></h3>
                            <h3></h3><a href="#">Price</a></h3>
                            <h3></h3><a href="#">Delivery</a></h3>
                        
        </nav>
      

    <div id="coords"></div>
    <div id="detail-view"></div>
    <script>
            function initMap() {
                var uluru = {lat: 47.6128967000, lng: -122.3405801000};
                var map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 15,
                  center: uluru
                });
                var marker = new google.maps.Marker({
                  position: uluru,
                  map: map
                });
              }
            </script>
            <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXzw_66pIoJMRo1Am2TpNyN0XaIl-0QKY&callback=initMap">
            </script>
            <div id="map"></div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
    <script src="scripts/models/rst.js"></script>
        <script>
            var est = '',
                userCoord = '';
            navigator.geolocation.getCurrentPosition(function(position) {
                console.log('position.coords.latitude',position.coords.latitude,'position.coords.longitude',position.coords.longitude);
              userCoord = {
                  long: position.coords.longitude,
                  lat: position.coords.latitude
              }
              console.log('userCoord lat',userCoord.lat,'userCoord long',userCoord.long);
              $.post('http://localhost:3000/api/v2.1/geocode',userCoord)
                .then(function(data){
                    var res = JSON.parse(data)
                    Neighborhood.all = new Neighborhood(res.location);
                    Popularity.all = new Popularity(res.popularity.top_cuisines)
                    NearbyRes.all = new NearbyRes(res.nearby_restaurants)

                    function getID(id){
                       for(index in NearbyRes.all){
                           if(id == NearbyRes.all[index].restaurant.id){
                               // Grab the template script
                               var theTemplateScript = $("#detail-template").html();
                               // Compile the template
                               var theTemplate = Handlebars.compile(theTemplateScript);
                               var context = {
                                   cuisines:NearbyRes.all[index].restaurant.cuisines,
                                   average_cost_for_two:NearbyRes.all[index].restaurant.average_cost_for_two,
                                   currency:NearbyRes.all[index].restaurant.currency,
                                   featured_image:NearbyRes.all[index].restaurant.featured_image,
                                   address:NearbyRes.all[index].restaurant.address,
                                   city:NearbyRes.all[index].restaurant.city,
                                   zipcode:NearbyRes.all[index].restaurant.zipcode,
                                   latitude:NearbyRes.all[index].restaurant.latitude,
                                   longitude:NearbyRes.all[index].restaurant.longitude,
                                   menu_url:NearbyRes.all[index].restaurant.menu_url,
                                   name:NearbyRes.all[index].restaurant.name,
                                   price_range:NearbyRes.all[index].restaurant.price_range,
                                   aggregate_rating:NearbyRes.all[index].restaurant.user_rating.aggregate_rating,
                                   votes:NearbyRes.all[index].restaurant.votes,
                                   url:NearbyRes.all[index].restaurant.url

                               }
                               // Pass our data to the template
                               var theCompiledHtml = theTemplate(context);

                               // Add the compiled html to the page
                               $('#detail-view').html(theCompiledHtml);
                           }
                       }
                   }
                   
                   getID('16720700');
                })
                .catch(function(err){ console.error(err)});
            });
     
           
          </script>

          <script>
          window.onscroll = function() {
  scrollFunction();
};

function scrollFunction() {
  if (document.body.scrollTop > 60 || document.documentElement.scrollTop > 60) {
    document.getElementById("myBtn").style.display = "block";
  } else {
    document.getElementById("myBtn").style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  if (window.scrollY != 0) {
    setTimeout(function() {
      window.scrollTo(0, window.scrollY - 900);
      topFunction();
    }, 40);
  }
}
          </script>
         <button onclick="topFunction()" id="myBtn">
                <span class="icon-arrow-up"></span>
           </button>
</body>
</html>
